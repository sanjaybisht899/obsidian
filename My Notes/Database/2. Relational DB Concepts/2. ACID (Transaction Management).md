---

---

---

In databases, **ACID properties** ensure that transactions are processed reliably. A **transaction** is a set of operations that must be executed together. If any part fails, the entire transaction should be undone.

## **1. ACID Properties**

ACID stands for:

1Ô∏è‚É£ **Atomicity** ‚Äì "All or Nothing"

- A transaction must be **fully completed or fully rolled back**.
- If any step fails, the entire transaction is undone.
- Example:
    - Transferring ‚Çπ1000 from Account A to Account B involves **debiting A and crediting B**. If the debit succeeds but the credit fails, the transaction is **rolled back**, so no money is lost.

2Ô∏è‚É£ **Consistency** ‚Äì "Valid State"

- The database must always move from **one valid state to another**.
- It ensures that all integrity constraints (e.g., primary key, foreign key) are maintained.
- Example:
    - A bank transfer should not create or lose money‚Äîit should only move existing funds correctly.

3Ô∏è‚É£ **Isolation** ‚Äì "No Interference"

- Transactions should **not affect each other** when running concurrently.
- Example:
    - Two people withdrawing money from the same account at the same time should not cause incorrect balances.

4Ô∏è‚É£ **Durability** ‚Äì "Permanent Changes"

- Once a transaction is committed, it is **permanently saved** in the database, even if a crash occurs.
- Example:
    - If ‚Çπ1000 is transferred and the transaction is committed, the change remains even if the system crashes.

---

## **2. Transactions and Commit/Rollback**

A **transaction** is a group of operations performed as a single unit.

- **COMMIT** ‚Äì Saves all changes permanently.
- **ROLLBACK** ‚Äì Undoes all changes if something goes wrong.

### **Example in SQL:**

```sql
START TRANSACTION;

UPDATE accounts SET balance = balance - 1000 WHERE account_id = 1;
UPDATE accounts SET balance = balance + 1000 WHERE account_id = 2;

COMMIT;  -- Saves the changes permanently
```

If something goes wrong (e.g., system crash), we can **ROLLBACK**:

```sql
ROLLBACK;  -- Undoes all changes
```

After **COMMIT**, you **cannot rollback** the transaction.

---

## **3. Isolation Levels** (Handling Concurrent Transactions)

Different **isolation levels** control how transactions interact with each other.

| Isolation Level  | Issues Prevented    | Allows Dirty Read? | Allows Non-Repeatable Read? | Allows Phantom Read? |
| ---------------- | ------------------- | ------------------ | --------------------------- | -------------------- |
| Read Uncommitted | None                | ‚úÖ Yes              | ‚úÖ Yes                       | ‚úÖ Yes                |
| Read Committed   | Dirty Read          | ‚ùå No               | ‚úÖ Yes                       | ‚úÖ Yes                |
| Repeatable Read  | Non-Repeatable Read | ‚ùå No               | ‚ùå No                        | ‚úÖ Yes                |
| Serializable     | Phantom Read        | ‚ùå No               | ‚ùå No                        | ‚ùå No                 |

### **Common Issues in Transactions:**

1. **Dirty Read** ‚Äì Reading uncommitted data from another transaction.
2. **Non-Repeatable Read** ‚Äì A row changes when read again in the same transaction.
3. **Phantom Read** ‚Äì A new row appears when reading the same query twice.

---
### Example of Phantom Read Issue:

#### **Session 1 (Transaction 1):**

```sql
START TRANSACTION;
SELECT * FROM orders WHERE status = 'pending'; -- Returns 5 rows
-- Waiting...
```

#### **Session 2 (Transaction 2, New Insert):**

```sql
INSERT INTO orders (id, status) VALUES (101, 'pending');
COMMIT;
```

#### **Back to Session 1:**

```sql
SELECT * FROM orders WHERE status = 'pending'; -- Returns 6 rows (New row appears)
```

---

### **Examples:**

üîπ **Read Uncommitted (Lowest Isolation, Fastest but Risky)**

- One transaction **modifies a row** but **does not commit**.
- Another transaction **reads the uncommitted data**, leading to incorrect results.

```sql
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
```

üîπ **Read Committed (Default in Most Databases)**

- A transaction **can only read committed data** from other transactions.
- **No dirty reads, but non-repeatable reads can still happen.**

```sql
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
```

üîπ **Repeatable Read (Stronger Isolation)**

- Prevents dirty and non-repeatable reads.
- But **phantom reads** can still occur.

```sql
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
```

üîπ **Serializable (Strongest Isolation, Slowest Performance)**

- Transactions are executed **one by one**.
- Prevents **all concurrency issues**, but reduces speed.

```sql
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
```

---
