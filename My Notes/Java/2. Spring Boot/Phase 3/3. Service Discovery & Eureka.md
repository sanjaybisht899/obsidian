
---
#### **1. What is Service Discovery?**

- **Definition**: In a distributed system, service discovery enables services to find and communicate with each other dynamically.
- **Types**:
    1. **Client-Side Discovery**: The client queries a service registry for the service location.
    2. **Server-Side Discovery**: A load balancer queries the registry and routes the request.

**Key Points for Interviews**:

- Avoids hardcoding of service URLs.
- Supports dynamic scaling and fault tolerance.
- Ensures high availability by balancing traffic among instances.

---

#### **2. What is Eureka?**

- **Definition**: A service registry tool developed by Netflix and part of the Spring Cloud Netflix stack.
- **Purpose**: Eureka acts as a registry where services can register themselves and discover other services.
- **Components**:
    - **Eureka Server**: Centralized registry.
    - **Eureka Client**: Services that register with and fetch data from the server.

---

#### **3. Setting Up Eureka Server**

1. **Add Dependencies**:
    
    - Add the `spring-cloud-starter-netflix-eureka-server` dependency.
    
    ```xml
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-netflix-eureka-server</artifactId>
    </dependency>
    ```
    
2. **Enable Eureka Server**:
    
    - Add `@EnableEurekaServer` in the main application class.
    
    ```java
    @SpringBootApplication
    @EnableEurekaServer
    public class EurekaServerApplication {
        public static void main(String[] args) {
            SpringApplication.run(EurekaServerApplication.class, args);
        }
    }
    ```
    
3. **Configure Properties**:
    
    - Add configurations in `application.yml`:
    
    ```yaml
    server:
      port: 8761
    
    eureka:
      client:
        register-with-eureka: false
        fetch-registry: false
    ```
    

**Key Points for Interviews**:

- The `register-with-eureka` and `fetch-registry` flags are `false` to prevent the server from registering itself.
- Default port for Eureka Server is `8761`.

---

#### **4. Registering Microservices with Eureka**

1. **Add Dependencies**:
    
    - Add the `spring-cloud-starter-netflix-eureka-client` dependency to each service.
    
    ```xml
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
    </dependency>
    ```
    
2. **Enable Eureka Client**:
    
    - Spring Boot automatically detects the dependency and enables Eureka Client.
3. **Configure Microservices**:
    
    - Add `application.yml` for each service:
    
    ```yaml
    spring:
      application:
        name: service-a
    
    eureka:
      client:
        service-url:
          defaultZone: http://localhost:8761/eureka/
    ```
    

**Key Points for Interviews**:

- The `spring.application.name` is the service identifier used in Eureka.
- `defaultZone` specifies the URL of the Eureka Server.

---

#### **5. Service Discovery in Action**

1. **Start Eureka Server**:
    
    - Run the Eureka Server application and access the dashboard at `http://localhost:8761`.
2. **Start Microservices**:
    
    - Start Service A and Service B.
    - Verify that both services appear in the Eureka dashboard.
3. **Invoke Services Using Discovery**:
    
    - Use `RestTemplate` or `WebClient` with the service name to call other services dynamically.
    - Example: Call Service B from Service A.
    
    ```java
    @RestController
    public class ServiceAController {
    
        private final RestTemplate restTemplate;
    
        public ServiceAController(RestTemplateBuilder builder) {
            this.restTemplate = builder.build();
        }
    
        @GetMapping("/call-service-b")
        public String callServiceB() {
            String response = restTemplate.getForObject("http://service-b/endpoint", String.class);
            return "Response from Service B: " + response;
        }
    }
    ```
    

**Key Points for Interviews**:

- Use **service names** (e.g., `http://service-b/`) instead of IP addresses or URLs for communication.
- Explain how Eureka handles service registration and failure detection (heartbeat mechanism).

---

#### **6. Common Interview Questions**

1. What is service discovery, and why is it important?
2. How does Eureka work in a microservices architecture?
3. What are the differences between `register-with-eureka` and `fetch-registry`?
4. How does Eureka handle service failure?
    - **Answer**: Eureka uses a heartbeat mechanism where clients periodically send heartbeat signals to the server. If the server doesn't receive a heartbeat within a specified period, the instance is marked as unavailable.
5. What are the alternatives to Eureka for service discovery?
    - Examples: Consul, Zookeeper, Kubernetes.

---
